<UserControl x:Class="VetManagement.Views.OwnersView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:VetManagement.Views" xmlns:services="clr-namespace:VetManagement.Services"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">

 
    
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <services:CommandParameterToIntConverter x:Key="CommandParameterToIntConverter"/>
        
        <!-- Define a colorful style for the button -->
        <Style TargetType="Button" x:Key="CreateOwnerButtonStyle">
            <Setter Property="Background" Value="#FF4CAF50"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="BorderBrush" Value="#FF388E3C"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="Width" Value="200"/>
        </Style>

        <!-- Define a colorful style for TextBoxes -->
        <Style TargetType="TextBox" x:Key="TextBoxStyle">
            <Setter Property="Background" Value="#FFFFFFFF"/>
            <Setter Property="Foreground" Value="#FF333333"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderBrush" Value="#FFBBBBBB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <!-- Define a style for ComboBox -->
        <Style TargetType="ComboBox" x:Key="ComboBoxStyle">
            <Setter Property="Background" Value="#FFFFFFFF"/>
            <Setter Property="Foreground" Value="#FF333333"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="BorderBrush" Value="#FFBBBBBB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <!-- Define a colorful style for ListView -->
        <Style TargetType="ListView" x:Key="OwnerListStyle">
            <Setter Property="Background" Value="#FFEEEEEE"/>
            <Setter Property="Foreground" Value="#FF333333"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="BorderBrush" Value="#FFBBBBBB"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Margin" Value="10"/>
        </Style>
        <!-- Define a colorful style for ListViewItem -->
        <Style TargetType="ListViewItem" x:Key="OwnerListItemStyle">
            <Setter Property="Background" Value="#FFFFFFFF"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="BorderBrush" Value="#FFCCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Style.Triggers>
                <DataTrigger Value="True">
                    <DataTrigger.Binding>
                        <Binding Path="IsSelected"/>
                    </DataTrigger.Binding>
                    <Setter Property="Background" Value="#FFD8F9E8"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </UserControl.Resources>

    <Grid Background="#FFFAF3F0">
        <!-- Owner List -->
        <ListView Name="OwnerList" ItemsSource="{Binding Owners}" Style="{StaticResource OwnerListStyle}" Margin="10,10,10,70">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Data Înscriere" DisplayMemberBinding="{Binding DateAddedFormated}" Width="150"/>
                    <GridViewColumn Header="Nume" DisplayMemberBinding="{Binding Name}" Width="200"/>
                    <GridViewColumn Header="Adresă" DisplayMemberBinding="{Binding Address}" Width="200"/>
                    <GridViewColumn Header="Telefon" DisplayMemberBinding="{Binding Phone}" Width="100"/>
                    <GridViewColumn Header="Email" DisplayMemberBinding="{Binding Email}" Width="250"/>
                    <GridViewColumn Header="Animale"  Width="300">

                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <ComboBox ItemsSource="{Binding Patients}"
                                          SelectedItem="{Binding Id, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                          DisplayMemberPath="Name"
                                          Width="200"/>
                                    <Button Content="➕" Background="Green"
                                            Command="{Binding DataContext.NavigateCreatePatientCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                            CommandParameter="{Binding Id, Converter={StaticResource CommandParameterToIntConverter}}"/>
                                    
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    
                    </GridViewColumn>
                    
                    <GridViewColumn Header="Detalii" DisplayMemberBinding="{Binding Details}" Width="300"/>

                    <GridViewColumn Header="Acțiuni" Width="100">

                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                <Button Content="Delete" Background="Red"
                                        Command="{Binding DataContext.DeleteOwnerCommand, RelativeSource={RelativeSource AncestorType=ListView}}"
                                        CommandParameter="{Binding Id, Converter={StaticResource CommandParameterToIntConverter}}" 
                                      />
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>

                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Create Owner Button -->
        <Button Content="Create Owner" HorizontalAlignment="Center" VerticalAlignment="Bottom"
                Style="{StaticResource CreateOwnerButtonStyle}" Command="{Binding NavigateCreateOwnerCommand}" VerticalContentAlignment="Center" 
                />
    </Grid>
</UserControl>
