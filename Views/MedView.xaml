<UserControl x:Class="VetManagement.Views.MedView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:VetManagement.Views" xmlns:services="clr-namespace:VetManagement.Services" xmlns:components="clr-namespace:VetManagement.Components"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
        <UserControl.Resources>
            <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
            <services:CommandParameterToIntConverter x:Key="CommandParameterToIntConverter"/>
        </UserControl.Resources>
    <Grid>

        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Top Bar -->
                <!-- Hidden Form -->
                <RowDefinition Height="*"/>
                <!-- Table -->
            </Grid.RowDefinitions>

            <!-- 🡨 Back Button + Add New Item -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="5">
                <Button Content="🡨 Back" Padding="10,5" Background="#2196F3" Foreground="White"
                FontWeight="Bold" BorderThickness="0" Cursor="Hand"
                Command="{Binding NavigateInventoryCommand}" />
                <TextBlock  Text="{Binding DataContext.Name}"/>
            </StackPanel>

            <!-- 📋 Hidden Form (Appears When Editing or Adding) -->


            <!-- 📋 Inventory Table -->
            <DataGrid Grid.Row="1" ItemsSource="{Binding Meds}" AutoGenerateColumns="False"
              HeadersVisibility="Column" CanUserAddRows="False" CanUserDeleteRows="False"
              Background="White" BorderThickness="1" BorderBrush="#DDD">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Data" Binding="{Binding DateAddedFormated, StringFormat='yyyy-MM-dd HH:mm:ss'}" Width="150"/>
                    <DataGridTextColumn Header="Serie Lot" Binding="{Binding LotID}" Width="*"/>
                    <DataGridTextColumn Header="Quantity" Binding="{Binding Valability}" Width="100"/>
                    <DataGridTextColumn Header="Nume Proprietar" Binding="{Binding OwnerName}" Width="120"/>
                    <DataGridTextColumn Header="Adresa" Binding="{Binding OwnerAddress}" Width="150"/>
                    <DataGridTextColumn Header="Specie" Binding="{Binding Species}" Width="150"/>
                    <DataGridTextColumn Header="Rasa" Binding="{Binding Race}" Width="*"/>
                    <DataGridTextColumn Header="Sex" Binding="{Binding Sex}" Width="*"/>
                    <DataGridTextColumn Header="Doze Folosite" Binding="{Binding MedCount}" Width="*"/>

                    <!-- 🖊 Edit Button Column -->
                    <DataGridTemplateColumn Width="Auto">
                        <DataGridTemplateColumn.Header>
                            <TextBlock Text="Actions"/>
                        </DataGridTemplateColumn.Header>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="✏ Edit" Padding="5,2" Background="#FFC107"
                                Foreground="White" BorderThickness="0" Cursor="Hand"
                                Command="{Binding DataContext.EditItemCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                CommandParameter="{Binding}" />

                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                    </DataGridTemplateColumn>

                    <DataGridTemplateColumn Width="Auto">
                        <DataGridTemplateColumn.Header>
                            <TextBlock Text="Actions"/>
                        </DataGridTemplateColumn.Header>
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="View" Padding="5,2" Background="Green"
                        Foreground="White" BorderThickness="0" Cursor="Hand"
                        Command="{Binding DataContext.NavigateViewMedCommand, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                        CommandParameter="{Binding Id, Converter={StaticResource CommandParameterToIntConverter}}" />
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>

                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Grid>
    </Grid>
</UserControl>
